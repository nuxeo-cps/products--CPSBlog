<!-- $Id$ -->
<tal:block metal:define-macro="blog_entry_listing"
	   tal:condition="items"
	   tal:define="batch python:Batch(items, b_size, int(b_start), orphan=1)">

  <div metal:use-macro="here/batch_navinfo_macros/macros/navinfo" />

  <div tal:repeat="item batch">
    <span tal:omit-tag=""
	  tal:define="bentry item/getContent; bentry_url item/absolute_url">
      <tal:block condition="day_separators|nothing">
	<h4 class="blog"
	    tal:define="be_datetime bentry/created"
	    tal:condition="python: item.getId() in day_separators">
	  <span tal:omit-tag="" i18n:translate="" tal:content="be_datetime/Month">Month</span>
	  <span tal:omit-tag="" tal:content="python: be_datetime.strftime(' %d, %Y')" />
	</h4>
      </tal:block>
      <h5 class="blog">
	<a href=""
	   class="blog"
	   tal:attributes="href bentry_url"
	   tal:content="bentry/title" />
      </h5>
      <div tal:condition="python:doc.view_mode == 'title_desc' or
			  doc.view_mode == 'full'"
	   tal:content="bentry/description" class="row"/>
      <div tal:condition="python:doc.view_mode == 'full'"
	   tal:content="structure bentry/content" class="row" />
      <tal:block define="categories python:item.getContent().Subject();
			 dname python:here.portal_directories.members.getEntry(doc.Creator(), default=None);
			 cname dname/fullname|doc/Creator;
			 info python:(here_url != utool.getPortalObject().absolute_url())
			 and here.getContentInfo(proxy=item, level=2) or None;
			 email dname/email|nothing;">
	<div class="posted">

	  <tal:block condition="not:isAnon" i18n:translate="">
	    Posted by
	    <a href="." title="Here" tal:omit-tag="not:email"
	       class="blog"
	       tal:condition="not:isAnon"
	       tal:attributes="href string:mailto:${email}?subject=[${doc/title}]; title email"
	       tal:content="cname" i18n:name="item_creator">Creator</a>

	    @
	    <tal:block
		content="python:here.getDateStr(bentry.modification_date, 'medium')"
		i18n:name="item_modification"/>
	    <tal:block condition="info">
	      <span i18n:translate="label_status">Label Status</span>
	      <span tal:content="info/review_state"
		    tal:attributes="class info/review_state" i18n:translate="">Work</span>
	    </tal:block>
	  </tal:block>

	  <tal:block condition="isAnon" i18n:translate="">
	    Posted by
	    <span tal:condition="isAnon"
		  i18n:name="item_creator"
		  tal:content="cname">Creator(Author)</span>
	    @
	    <tal:block
		content="python:here.getDateStr(bentry.modification_date, 'medium')"
		i18n:name="item_modification"/>
	  </tal:block>

	  <tal:block condition="categories">
	    -
	    <tal:block i18n:translate="blog_categories_byline_label">Categories:</tal:block>
	    <tal:block repeat="item categories">
	      <a href=""
		 class="blog"
		 tal:attributes="href string:${here/absolute_url}/archive_view?category=${item}"
		 tal:content="item">
		category name
	      </a><span tal:replace="string:," tal:condition="not:repeat/item/end">comma</span>
	    </tal:block>
	  </tal:block>
	  -&nbsp;
	  <tal:block i18n:translate="">
	    <span i18n:name="numofcomments"
		  tal:replace="python:here.getNumberOfComments(item)">5</span>
	    comments
	  </tal:block>
	  <tal:block condition="item/hasCommentAction">
	    (<a href="" class="blog" tal:attributes="href string:${bentry_url}/post_comment" i18n:translate="">add</a>)
	  </tal:block>
	</div>

      </tal:block>
    </span>
  </div>

  <div metal:use-macro="here/batch_nav_macros/macros/navigation" />

</tal:block>
