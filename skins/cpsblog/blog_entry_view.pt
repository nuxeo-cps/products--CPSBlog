<html metal:use-macro="here/content_lib_master/macros/master">
  <metal:block fill-slot="header">
  </metal:block>

  <metal:block fill-slot="css_slot">
    <link rel="Stylesheet" type="text/css" href=""
	  tal:attributes="href string:${base_url}document.css" />
    <link rel="Stylesheet" type="text/css" href=""
	  tal:attributes="href string:${base_url}blog.css" />
  </metal:block>

  <metal:block fill-slot="main">
    <div class="navigationBar"
	 tal:define="info python:here.getBlogEntryNavLinksInfo()"
	 tal:condition="info">

      <span tal:condition="info/prev_url">
	<a href="" class="blog"
	   tal:attributes="href info/prev_url">
	  &laquo;
	  <span tal:replace="info/prev_title" />
	</a>
	|
      </span>

      <span tal:condition="python: info['prev_url'] or info['next_url']">
	<a href="" class="blog"
	   tal:attributes="href python:here.getBlogProxy().absolute_url()">
	  <tal:block i18n:translate="">Main</tal:block>
	</a>
      </span>

      <span tal:condition="info/next_url">
	|
	<a href="" class="blog"
	   tal:attributes="href info/next_url">
	  <span tal:replace="info/next_title" />
	  &raquo;
	</a>
      </span>
    </div>

    <div metal:use-macro="here/blog_entry_actions/macros/blog_entry_actions">
      Document actions (print, etc)
    </div>

    <tal:block tal:content="structure rendered_main|python:doc.render(proxy=here)" />

    <tal:block tal:condition="python:hasattr(here,'portal_discussion') and
      hasattr(here.portal_discussion, 'isCommentingAllowedFor')">
      <tal:block tal:define="comments_allowed
        python:here.portal_discussion.isCommentingAllowedFor(here);"
        tal:condition="comments_allowed">
        <metal:block
          use-macro="here/forum_comment_lib_view_comments_inline/macros/view_comments_inline" />
      </tal:block>
    </tal:block>

  </metal:block>

  <metal:block fill-slot="sub">
    <div tal:condition="not:creation|nothing" id="byline">
      <small>
	<tal:block
	    tal:define="categories python:doc.Subject();
			dname python:here.portal_directories.members.getEntry(doc.Creator(), default=None);
			cname dname/fullname|doc/Creator;
			info python:(here_url != utool.getPortalObject().absolute_url())
			and here.getContentInfo(doc=doc, level=2) or None;
			email dname/email|nothing;">
	  <div class="posted">

	    <tal:block condition="not:isAnon" i18n:translate="">
	      Posted by
	      <a href="." title="Here" tal:omit-tag="not:email"
		 class="blog"
		 tal:condition="not:isAnon"
		 tal:attributes="href string:mailto:${email}?subject=[${doc/title}]; title email"
		 tal:content="cname" i18n:name="item_creator">Creator</a>

	      @
	      <tal:block
		  content="python:here.getDateStr(doc.modification_date, 'medium')"
		  i18n:name="item_modification"/>
	      <tal:block condition="info">
		<span i18n:translate="label_status">Label Status</span>
		<span tal:content="info/review_state"
		      tal:attributes="class info/review_state" i18n:translate="">Work</span>
	      </tal:block>
	    </tal:block>

	    <tal:block condition="isAnon" i18n:translate="">
	      Posted by
	      <span tal:condition="isAnon"
		    i18n:name="item_creator"
		    tal:content="cname">Creator(Author)</span>
	      @
	      <tal:block
		  content="python:here.getDateStr(doc.modification_date, 'medium')"
		  i18n:name="item_modification"/>
	    </tal:block>

	    <tal:block condition="categories">
	      -
	      <tal:block i18n:translate="blog_categories_byline_label">Categories:</tal:block>
	      <tal:block repeat="item categories">
		<a href=""
		   class="blog"
		   tal:attributes="href string:${here/absolute_url}/archive_view?category=${item}"
		   tal:content="item">
		  category name
		  </a><span tal:replace="string:," tal:condition="not:repeat/item/end">comma</span>
	      </tal:block>
	    </tal:block>
	    -&nbsp;
	    <tal:block i18n:translate="">
	      <span i18n:name="numofcomments"
		    tal:replace="python:here.getNumberOfComments(here)">5</span>
	      comments
	    </tal:block>
	    <tal:block condition="here/hasCommentAction">
	      (<a href="" class="blog" tal:attributes="href string:${here/absolute_url}/post_comment" i18n:translate="">add</a>)
	    </tal:block>
	  </div>

	</tal:block>
      </small>
    </div>
  </metal:block>

</html>
