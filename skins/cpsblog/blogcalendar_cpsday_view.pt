<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="here/main_template/macros/master">

<div metal:fill-slot="header">&nbsp;</div>

<div metal:fill-slot="main">

 <div metal:define-macro="dayViewBox"
      class="dayViewBox"
      tal:define="DateTime python:modules['DateTime'].DateTime;
                  this_day  python:DateTime(request.get('date',
		                            DateTime().aCommon()[:12]))">

  <tal:block tal:define="items python:here.getBlogEntriesForThisDay(this_day, request);
                         format string:detail;
                         no_form python:1;
			 params python:here.getCustomDisplayParams();
			 mq nocall:modules/ZTUtils/make_query;
			 items_per_page params/items_per_page;
			 columns python:1;
			 batches_all python:here.getBatchList(items, columns, items_per_page);
			 batches python:batches_all[0];
			 batch_info python:batches_all[1]">
    <span tal:condition="python:len(items)==1"
          tal:content="python:request.response.redirect(items[0].getURL()+'?'+mq(request.form))" />
    <tal:block tal:condition="python:len(items)!=1">
      <h1><span tal:omit-tag=""
            i18n:translate="label_blog_calendar_entries_list">
            Blog entries published</span>
          <span tal:omit-tag="" tal:content="python:here.getDateStr(this_day, 'short')" />
      </h1>
      <tal:block tal:condition="python: batch_info and batch_info['nb_pages'] > 1">
	<div class="batchLayout">
	  <span i18n:translate="">
	    Objects: <tal:block replace="batch_info/start"
	    i18n:name="batch_start" /> - <tal:block replace="batch_info/limit"
	    i18n:name="batch_limit" /> of <tal:block replace="batch_info/length"
	    i18n:name="batch_length" />
	  </span>
	</div>
	<br />
      </tal:block>
      <tal:block tal:condition="batches">
	<div tal:repeat="item python:batches[0]" class="group">
	  <span tal:omit-tag=""
		tal:define="bentry item/getContent; bentry_url item/absolute_url">
	    <h3>
	      <a href=""
		 tal:attributes="href bentry_url"
		 tal:content="bentry/title" />
	    </h3>
            <div tal:content="structure bentry/description" class="row" />
	    <div class="row">
	      <a href=""
		 tal:attributes="href bentry_url"
		 i18n:translate="blog_entry_comments_label">comments</a>:
	      <span
		  tal:omit-tag=""
		  tal:content="python:here.getNumberOfComments(item)" />
	    </div>
	    <form method="post"
		  action=""
		  tal:attributes="action string:${bentry_url}/post_comment">
	      <input type="submit" value="button_add_comment"
		     class="standalone" i18n:attributes="value"/>
	    </form>
	  </span>
	</div>
      </tal:block>
      <tal:block condition="python:batch_info and batch_info['nb_pages'] > 1">
	<br />
	<div class="pageNavigationLayout">
	  <span i18n:translate="label_page">Pages</span>:
	  <a tal:define="previous batch_info/previous"
	     tal:condition="python:previous is not None"
	     tal:attributes="href python:'%s?%s'%(request['URL'],
			     mq(request.form, b_start=previous))"
	     i18n:translate="batch_previous">Previous</a>
	  <tal:block repeat="page batch_info/pages">
	    <a tal:condition="python:page != batch_info['start'] - 1"
	       tal:attributes="href python:'%s?%s'%(request['URL'],
			       mq(request.form, b_start=page))"
	       tal:content="repeat/page/number">1</a>
	    <span tal:condition="python:page == batch_info['start'] - 1"
		  tal:content="string:[${repeat/page/number}]" />
	  </tal:block>
	  <a tal:define="next batch_info/next"
	     tal:condition="python:next is not None"
	     tal:attributes="href python:'%s?%s'%(request['URL'],
			     mq(request.form, b_start=next))"
	     i18n:translate="batch_next">Next</a>
	</div>
      </tal:block>
    </tal:block>

  </tal:block>

 </div>
</div>

</html>
